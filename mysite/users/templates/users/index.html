{% extends 'users/base.html' %}

{% block body %}
<div class="container mt-4">

    {% if user.is_authenticated %}
    <h4 class="mb-4 text-center recent-posts-title">
        Recent Posts
    </h4>

    {% if posts %}
    <div class="d-flex flex-column align-items-center">
        {% for post in posts reversed %}
        <div class="post-wrapper">
            <div class="card post-card shadow-sm border-0 rounded-4 mb-4">

                <!-- Post Header -->
                <div class="card-header border-0 d-flex align-items-center p-3 post-header">
                    <a href="{% url 'user_posts' post.user.username %}" class="text-decoration-none">
                        <img src="{{ post.user.profile.photo.url }}" alt="Profile" class="rounded-circle me-2"
                            style="width:40px;height:40px;object-fit:cover;">
                    </a>

                    <div>
                        <h6 class="mb-0 fw-bold">
                            <a href="{% url 'user_posts' post.user.username %}"
                                class="text-decoration-none username-link">
                                {{ post.user.username }}
                            </a>
                        </h6>
                        <small class="text-muted post-date">{{ post.date|date:"M d, Y" }}</small>
                    </div>
                </div>

                <!-- Post Image -->
                <div class="ratio ratio-1x1">
                    <img src="{{ post.image.url }}" class="post-img" alt="{{ post.title }}">
                </div>

                <!-- Post Body -->
                <div class="card-body">
                    <h5 class="fw-bold mb-2 post-title">{{ post.title }}</h5>
                    <p class="mb-0 post-caption">{{ post.caption }}</p>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <p class="text-center mt-4 text-muted fs-5">No posts yet.</p>
    {% endif %}

    {% else %}
    <div class="text-center py-5">
        <h1 class="fw-bold display-4 mb-3 welcome-title">
            ðŸ‘‹ Welcome to <span class="brand-text">Vibely</span>
        </h1>
        <p class="lead mb-4 welcome-subtitle">
            Connect, share, and explore with friends around the world.
        </p>
        <a href="{% url 'login' %}" class="btn btn-outline-primary btn-lg rounded-pill px-4 shadow-sm me-3">
            Log In
        </a>
        <a href="{% url 'register' %}" class="btn btn-outline-primary btn-lg rounded-pill px-4 shadow-sm">
            Sign Up
        </a>
    </div>
    {% endif %}

</div>

<style>
    .post-wrapper {
        width: 100%;
        max-width: 400px;
    }

    .post-card {
        background: #fff;
        overflow: hidden;
        width: 100%;
        color: #222;
        transition: background 0.3s, color 0.3s, box-shadow 0.3s;
    }

    .post-card:hover {
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
    }

    .post-header {
        background: #fff;
        transition: background 0.3s;
    }

    .post-img {
        object-fit: cover;
        width: 100%;
        height: 100%;
        border-top: 1px solid #eee;
        border-bottom: 1px solid #eee;
    }

    .post-title {
        color: #333;
    }

    .post-caption {
        color: #555;
    }

    /* ðŸŒ™ DARK MODE OVERRIDES */
    body.dark-mode {
        background: #121212;
        color: #f1f1f1;
    }

    body.dark-mode .recent-posts-title {
        color: #f1f1f1 !important;
    }

    body.dark-mode .post-card {
        background: #1e1e1e;
        color: #f1f1f1;
    }

    body.dark-mode .post-header {
        background: #1e1e1e;
    }

    body.dark-mode .post-title {
        color: #ffffff;
    }

    body.dark-mode .post-caption {
        color: #cccccc;
    }

    body.dark-mode .username-link {
        color: #f1f1f1 !important;
    }

    body.dark-mode .post-date {
        color: #aaaaaa !important;
    }

    body.dark-mode .welcome-title {
        color: #ffffff !important;
    }

    body.dark-mode .welcome-subtitle {
        color: #cccccc !important;
    }

    .brand-text {
        color: #6a11cb;
    }
</style>
{% endblock %}